# 校园地图设计文档 v2.0

## 📐 总体布局

本校园采用**河流分隔式布局**,分为三大区域:

```
┌─────────────────────────────────────────────────┐
│              河北区域 (北部教学区)                │
│  ┌─────┬─────┬─────┬─────┐  ┌───────┐  ┌─────┬─────┬─────┬─────┐
│  │ D3a │ D3b │ D3c │ D3d │  │ 图书馆 │  │ F3a │ F3b │ F3c │ F3d │
│  └─────┴─────┴─────┴─────┘  └───────┘  └─────┴─────┴─────┴─────┘
│   (教学楼D - 西北区)          (正北)      (教学楼F - 东北区)
├─────────────────────────────────────────────────┤
│                   河流与桥梁                     │
│         🌉        🌉        🌉        🌉         │
│    西桥     中左桥     中右桥     东桥           │
├─────────────────────────────────────────────────┤
│              河南区域 (南部生活区)                │
│                                                 │
│    ┌────────┐     ┌────────┐     ┌────┬────┐  │
│    │        │     │  健身房 │     │D5a │D5b │  │
│    │  食堂   │     ├────────┤     ├────┼────┤  │
│    │        │     │  操场   │     │D5c │D5d │  │
│    └────────┘     └────────┘     └────┴────┘  │
│    (西南区)        (正南区)        (东南区)     │
└─────────────────────────────────────────────────┘
```

---

## 🏢 建筑详细信息

### 北部教学区 (河北区域)

#### 教学楼D (西北区域) - 4个教室
| 建筑ID | 名称 | 坐标 | 用途 |
|--------|------|------|------|
| D3a | Room D3a | (120, 120) | 教室 - 计算机/化学 |
| D3b | Room D3b | (240, 120) | 教室 - 英语 |
| D3c | Room D3c | (360, 120) | 教室 - 数学/英语 |
| D3d | Room D3d | (480, 120) | 教室 - 物理 |

#### 图书馆 (正北区域)
| 建筑ID | 名称 | 坐标 | 用途 |
|--------|------|------|------|
| library | Library | (640, 100) | 自习、阅读、午休 |

#### 教学楼F (东北区域) - 4个教室
| 建筑ID | 名称 | 坐标 | 用途 |
|--------|------|------|------|
| F3a | Room F3a | (800, 120) | 教室 - 计算机/物理 |
| F3b | Room F3b | (920, 120) | 教室 - 计算机/英语 |
| F3c | Room F3c | (1040, 120) | 教室 - 数学/化学 |
| F3d | Room F3d | (1160, 120) | 教室 - 数学/化学 |

### 河流与桥梁 (中线区域)

**重要**: 这是南北区域的**唯一连接**!

| 建筑ID | 名称 | 坐标 | 连接区域 |
|--------|------|------|----------|
| bridge_west | West Bridge | (200, 360) | 教学楼D ↔ 食堂 |
| bridge_mid_left | Mid-Left Bridge | (450, 360) | 图书馆 ↔ 食堂/健身房 |
| bridge_mid_right | Mid-Right Bridge | (830, 360) | 图书馆/教学楼F ↔ 健身房/宿舍 |
| bridge_east | East Bridge | (1080, 360) | 教学楼F ↔ 宿舍 |

### 南部生活区 (河南区域)

#### 食堂 (西南区域)
| 建筑ID | 名称 | 坐标 | 用途 | 使用时间 |
|--------|------|------|------|----------|
| canteen | Canteen | (280, 580) | 餐饮 | 07:30-08:00 (早餐)<br>12:00-13:00 (午餐)<br>18:00-19:00 (晚餐) |

#### 运动区域 (正南区域)
| 建筑ID | 名称 | 坐标 | 用途 |
|--------|------|------|------|
| gym | Gym | (640, 560) | 体育课、健身 |
| playground | Playground | (640, 640) | 户外活动、休闲 |

#### 宿舍区 (东南区域) - 4栋宿舍楼
| 建筑ID | 名称 | 坐标 | 居住班级 |
|--------|------|------|----------|
| D5a | Dorm D5a | (920, 560) | 计算机班 + 化学班 |
| D5b | Dorm D5b | (1040, 560) | 数学班 |
| D5c | Dorm D5c | (920, 640) | 物理班 |
| D5d | Dorm D5d | (1040, 640) | 英语班 |

---

## 🛣️ 道路网络

### 设计原则
1. **河流隔离**: 南北区域仅通过4座桥连接
2. **区域内连通**: 同一区域内建筑物充分连接
3. **合理距离**: 路径长度基于真实步行时间(60-100米/分钟)

### 路径统计
| 区域 | 路径数量 | 主要连接 |
|------|---------|----------|
| 北部教学区 | 10条 | 教学楼横向 + 到图书馆 + 到桥梁 |
| 桥梁连接 | 6条 | 4座桥的南北连接 |
| 南部生活区 | 10条 | 食堂-体育-宿舍网络 |
| **总计** | **26条** | **双向52条边** |

### 关键路径详解

#### 1. 教学区内部 (北部)
```
D3a --- D3b --- D3c --- D3d --- library --- F3a --- F3b --- F3c --- F3d
 |       |       |       |                   |       |       |       |
 └───────┴───────┴───────┴─── 到桥梁 ───────┴───────┴───────┴───────┘
```

#### 2. 河流跨越 (桥梁)
```
北部教学区
    │
西桥 │ 中左桥 │ 中右桥 │ 东桥
    │
南部生活区
```

#### 3. 生活区网络 (南部)
```
       食堂 ─────── 健身房 ─────── 宿舍D5a ─── 宿舍D5b
        │            │              │           │
        └─── 操场 ────┘              │           │
                                  宿舍D5c ─── 宿舍D5d
```

---

## 👥 班级与课表设计

### 班级分布

| 班级代码 | 班级名称 | 人数 | 宿舍楼 |
|---------|---------|------|--------|
| CS1 | CS Class 1 | 20 | D5a |
| MATH | Math Class 2 | 20 | D5b |
| PHYS | Physics Class 3 | 20 | D5c |
| ENG | English Class 4 | 20 | D5d |
| CHEM | Chemistry Class 5 | 20 | D5a |
| **总计** | | **100** | |

### 课表设计原则

1. **合理时间**: 早上7:00起床, 晚上21:00-22:00返回宿舍
2. **用餐时间**: 早餐30-40分钟, 午餐/晚餐30-40分钟
3. **课程间隔**: 每节课2小时, 中间有移动时间
4. **多样活动**: 上课、自习、运动、用餐、休息

### 典型课表示例 (计算机班)

| 时间 | 地点 | 活动 | 持续时间 |
|------|------|------|----------|
| 07:00 | D5a | 起床 | - |
| 07:30-08:00 | 食堂 | 早餐 | 30分钟 |
| 08:00-10:00 | D3a | 上课 | 2小时 |
| 10:00-12:00 | D3b | 上课 | 2小时 |
| 12:00-12:40 | 食堂 | 午餐 | 40分钟 |
| 12:40-14:00 | 图书馆 | 午休/自习 | 1小时20分 |
| 14:00-16:00 | F3a | 上课 | 2小时 |
| 16:00-18:00 | F3b | 上课 | 2小时 |
| 18:00-18:30 | 食堂 | 晚餐 | 30分钟 |
| 18:30-21:30 | 图书馆 | 晚自习 | 3小时 |
| 21:30 | D5a | 回宿舍休息 | - |

---

## 🎯 设计亮点

### 1. 真实性
- ✅ 河流作为自然屏障
- ✅ 桥梁作为重要交通节点
- ✅ 教学区与生活区分离
- ✅ 符合大学校园典型布局

### 2. 复杂度
- ✅ 20个建筑节点
- ✅ 26条路径 (52条有向边)
- ✅ 5个不同班级
- ✅ 100名学生独立移动

### 3. 算法挑战
- ✅ 必须经过桥梁才能跨越河流
- ✅ 多种最短路径选择
- ✅ 拥堵控制(桥梁可作为瓶颈)
- ✅ 大规模路径规划

### 4. 可视化效果
- ✅ 清晰的南北分区
- ✅ 4座桥梁形成对称美感
- ✅ 学生跨河移动可观察
- ✅ 早晚高峰明显(用餐时间桥梁拥挤)

---

## 📊 数据统计

### 建筑统计
| 类型 | 数量 | 占比 |
|------|------|------|
| 教室 | 8 | 40% |
| 宿舍 | 4 | 20% |
| 桥梁 | 4 | 20% |
| 图书馆 | 1 | 5% |
| 食堂 | 1 | 5% |
| 体育设施 | 2 | 10% |
| **总计** | **20** | **100%** |

### 路径距离分布
| 距离范围 | 数量 | 说明 |
|---------|------|------|
| 80米 | 12条 | 相邻建筑 |
| 120-180米 | 10条 | 区域内连接 |
| 200-250米 | 4条 | 跨区域连接 |
| **平均** | **130米** | 步行约1-2分钟 |

### 课表统计
- **事件总数**: 55个/天 (5个班级 × 11个事件/班)
- **活动场所**: 每个班级使用6-8个不同建筑
- **跨河次数**: 每个学生每天至少4次 (去教学区2次, 回生活区2次)

---

## 🔧 技术实现

### 图数据结构
```python
Graph {
    buildings: Dict[str, Building]  # 20个节点
    _adjacency: Dict[str, Dict[str, Path]]  # 邻接表
}
```

### Dijkstra最短路径
- **起点**: 任意建筑
- **终点**: 任意建筑
- **约束**: 必须通过桥梁跨越河流
- **权重**: 旅行时间 (距离 × 难度系数 / 步行速度)

### 学生移动逻辑
1. 检查下一个课表事件
2. 使用Dijkstra计算最短路径
3. 分段移动 (Building → Building)
4. 到达后更新状态

---

## 🎮 使用体验

### 观察要点
1. **早高峰** (07:30-08:30): 学生从宿舍→食堂→教室, 桥梁繁忙
2. **午餐时间** (12:00-13:00): 大量学生从教学区→食堂, 桥梁拥挤
3. **晚餐时间** (18:00-19:00): 教学区→食堂→图书馆
4. **晚归时间** (21:00-22:00): 图书馆→宿舍, 桥梁又忙碌

### 交互功能
- **点击学生**: 查看所属班级、当前位置、目标位置
- **路径高亮**: 看到学生如何跨越河流
- **统计面板**: 观察5个班级的分布

---

## 📝 版本更新

### v2.0 (2025-10-21)
- ✅ 重新设计校园布局
- ✅ 引入河流与桥梁概念
- ✅ 从10栋建筑扩展到20栋
- ✅ 合理化课表时间 (无凌晨课程)
- ✅ 优化用餐时间 (30-40分钟)
- ✅ 4栋宿舍明确分配给5个班级
- ✅ 更真实的校园体验

### v1.0 (原始版本)
- 简单布局, 10栋建筑
- 无河流概念
- 基础课表系统

---

## 🏆 教学价值

### 数据结构学习
- ✅ **图**: 20个节点, 52条边
- ✅ **最短路径**: Dijkstra算法实战
- ✅ **优先队列**: heapq使用
- ✅ **邻接表**: 稀疏图存储

### 算法分析
- ✅ **时间复杂度**: O((E+V)logV) = O(72×log20) ≈ O(312)
- ✅ **空间复杂度**: O(V+E) = O(20+52) = O(72)
- ✅ **路径重建**: 回溯前驱节点

### 系统设计
- ✅ **面向对象**: 11个核心类
- ✅ **事件驱动**: 时间表调度
- ✅ **状态机**: 学生状态转换
- ✅ **可视化**: Pygame实时渲染

---

**设计团队**: Campus Simulation Development Team  
**最后更新**: 2025年10月21日  
**版本**: 2.0  
